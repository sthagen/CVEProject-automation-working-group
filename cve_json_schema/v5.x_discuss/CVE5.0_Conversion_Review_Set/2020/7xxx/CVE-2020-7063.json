{
    "CVE_data_meta": {
        "ASSIGNER": "security@php.net",
        "DATE_PUBLIC": "2020-02-17T16:21:00.000Z",
        "ID": "CVE-2020-7063",
        "STATE": "PUBLIC",
        "TITLE": "Files added to tar with Phar::buildFromIterator have all-access permissions",
        "UPDATED": "2020-06-15"
    },
    "cna-container": {
        "affected": {
            "vendors": [
                {
                    "products": [
                        {
                            "versions": [
                                {
                                    "version_value": "7.3.15"
                                },
                                {
                                    "version_value": "7.4.3"
                                },
                                {
                                    "version_value": "7.2.28"
                                }
                            ]
                        }
                    ],
                    "vendor_name": "PHP Group"
                }
            ]
        },
        "credits": [
            {
                "lang": "eng",
                "value": "Reported by dr at loopia dot rs"
            }
        ],
        "descriptions": [
            {
                "lang": "eng",
                "value": "In PHP versions 7.2.x below 7.2.28, 7.3.x below 7.3.15 and 7.4.x below 7.4.3, when creating PHAR archive using PharData::buildFromIterator() function, the files are added with default permissions (0666, or all access) even if the original files on the filesystem were with more restrictive permissions. This may result in files having more lax permissions than intended when such archive is extracted."
            }
        ],
        "generator": {
            "engine": "Vulnogram 0.0.9"
        },
        "metrics": [
            {
                "cvss-v_3_1": {
                    "attackComplexity": "LOW",
                    "attackVector": "LOCAL",
                    "availabilityImpact": "NONE",
                    "baseScore": 5.5,
                    "baseSeverity": "MEDIUM",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "NONE",
                    "privilegesRequired": "NONE",
                    "scope": "UNCHANGED",
                    "userInteraction": "REQUIRED",
                    "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N",
                    "version": "3.1"
                }
            }
        ],
        "problemtypes": {
            "descriptions": [
                [
                    {
                        "CWE-ID": "CWE-281 Improper Preservation of Permissions",
                        "description": "CWE-281 Improper Preservation of Permissions",
                        "lang": "eng",
                        "type": "CWE"
                    }
                ]
            ]
        },
        "references": [
            {
                "name": "https://bugs.php.net/bug.php?id=79082",
                "refsource": "MISC",
                "url": "https://bugs.php.net/bug.php?id=79082"
            },
            {
                "name": "openSUSE-SU-2020:0341",
                "refsource": "SUSE",
                "url": "http://lists.opensuse.org/opensuse-security-announce/2020-03/msg00023.html"
            },
            {
                "name": "GLSA-202003-57",
                "refsource": "GENTOO",
                "url": "https://security.gentoo.org/glsa/202003-57"
            },
            {
                "name": "[debian-lts-announce] 20200326 [SECURITY] [DLA 2160-1] php5 security update",
                "refsource": "MLIST",
                "url": "https://lists.debian.org/debian-lts-announce/2020/03/msg00034.html"
            },
            {
                "name": "USN-4330-1",
                "refsource": "UBUNTU",
                "url": "https://usn.ubuntu.com/4330-1/"
            }
        ],
        "source": {
            "defect": [
                "https://bugs.php.net/bug.php?id=79082"
            ],
            "discovery": "EXTERNAL"
        },
        "work_around": [
            {
                "lang": "eng",
                "value": "Use different Phar class functions to compose the archive, such as addFile(), or reset file permissions upon extracting files from the archive. "
            }
        ]
    },
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "5.0"
}