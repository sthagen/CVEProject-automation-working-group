{
    "CVE_data_meta": {
        "ASSIGNER": "sirt@juniper.net",
        "DATE_PUBLIC": "2018-10-10T16:00:00.000Z",
        "ID": "CVE-2018-0052",
        "STATE": "PUBLIC",
        "TITLE": "Junos OS: Unauthenticated remote root access possible when RSH service is enabled",
        "UPDATED": "2020-06-15"
    },
    "cna-container": {
        "affected": {
            "vendors": [
                {
                    "products": [
                        {
                            "versions": [
                                {
                                    "version_value": "12.1X46-D77"
                                },
                                {
                                    "version_value": "12.3R12-S10"
                                },
                                {
                                    "version_value": "12.3X48-D75"
                                },
                                {
                                    "version_value": "14.1X53-D47"
                                },
                                {
                                    "version_value": "15.1R4-S9, 15.1R6-S6, 15.1R7"
                                },
                                {
                                    "version_value": "15.1X49-D131, 15.1X49-D140"
                                },
                                {
                                    "version_value": "15.1X53-D59"
                                },
                                {
                                    "version_value": "15.1X53-D67"
                                },
                                {
                                    "version_value": "15.1X53-D233"
                                },
                                {
                                    "version_value": "15.1X53-D471, 15.1X53-D490"
                                },
                                {
                                    "version_value": "16.1R3-S9, 16.1R4-S9, 16.1R5-S4, 16.1R6-S4, 16.1R7"
                                },
                                {
                                    "version_value": "16.2R2-S5"
                                },
                                {
                                    "version_value": "17.1R1-S7, 17.1R2-S7, 17.1R3"
                                },
                                {
                                    "version_value": "17.2R1-S6, 17.2R2-S4, 17.2R3"
                                },
                                {
                                    "version_value": "17.2X75-D110, 17.2X75-D91"
                                },
                                {
                                    "version_value": "17.3R1-S4, 17.3R2-S2, 17.3R3"
                                },
                                {
                                    "version_value": "17.4R1-S3, 17.4R2"
                                },
                                {
                                    "version_value": "18.2X75-D5"
                                }
                            ]
                        }
                    ],
                    "vendor_name": "Juniper Networks"
                }
            ]
        },
        "configuration": [
            {
                "lang": "eng",
                "value": "This issue only affects configurations where RSH service is enabled and the PAM authentication is disabled."
            }
        ],
        "descriptions": [
            {
                "lang": "eng",
                "value": "If RSH service is enabled on Junos OS and if the PAM authentication is disabled, a remote unauthenticated attacker can obtain root access to the device. RSH service is disabled by default on Junos. There is no documented CLI command to enable this service. However, an undocumented CLI command allows a privileged Junos user to enable RSH service and disable PAM, and hence expose the system to unauthenticated root access. When RSH is enabled, the device is listing to RSH connections on port 514. This issue is not exploitable on platforms where Junos release is based on FreeBSD 10+. Affected releases are Juniper Networks Junos OS: 12.1X46 versions prior to 12.1X46-D77 on SRX Series; 12.3 versions prior to 12.3R12-S10; 12.3X48 versions prior to 12.3X48-D75 on SRX Series; 14.1X53 versions prior to 14.1X53-D47 on QFX/EX Series; 15.1 versions prior to 15.1R4-S9, 15.1R6-S6, 15.1R7; 15.1X49 versions prior to 15.1X49-D131, 15.1X49-D140 on SRX Series; 15.1X53 versions prior to 15.1X53-D59 on EX2300/EX3400 Series; 15.1X53 versions prior to 15.1X53-D67 on QFX10K Series; 15.1X53 versions prior to 15.1X53-D233 on QFX5200/QFX5110 Series; 15.1X53 versions prior to 15.1X53-D471, 15.1X53-D490 on NFX Series; 16.1 versions prior to 16.1R3-S9, 16.1R4-S9, 16.1R5-S4, 16.1R6-S4, 16.1R7; 16.2 versions prior to 16.2R2-S5; 17.1 versions prior to 17.1R1-S7, 17.1R2-S7, 17.1R3; 17.2 versions prior to 17.2R1-S6, 17.2R2-S4, 17.2R3; 17.2X75 versions prior to 17.2X75-D110, 17.2X75-D91; 17.3 versions prior to 17.3R1-S4, 17.3R2-S2, 17.3R3; 17.4 versions prior to 17.4R1-S3, 17.4R2; 18.2X75 versions prior to 18.2X75-D5."
            }
        ],
        "exploit": [
            {
                "lang": "eng",
                "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
            }
        ],
        "metrics": [
            {
                "cvss-v_3_0": {
                    "attackComplexity": "LOW",
                    "attackVector": "NETWORK",
                    "availabilityImpact": "HIGH",
                    "baseScore": 7.2,
                    "baseSeverity": "HIGH",
                    "confidentialityImpact": "HIGH",
                    "integrityImpact": "HIGH",
                    "privilegesRequired": "HIGH",
                    "scope": "UNCHANGED",
                    "userInteraction": "NONE",
                    "vectorString": "CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
                    "version": "3.0"
                }
            }
        ],
        "problemtypes": {
            "descriptions": [
                [
                    {
                        "description": "Unauthenticated remote root access",
                        "lang": "eng",
                        "type": "text"
                    }
                ]
            ]
        },
        "references": [
            {
                "name": "1041853",
                "refsource": "SECTRACK",
                "url": "http://www.securitytracker.com/id/1041853"
            },
            {
                "name": "https://kb.juniper.net/JSA10886",
                "refsource": "CONFIRM",
                "url": "https://kb.juniper.net/JSA10886"
            }
        ],
        "solution": [
            {
                "lang": "eng",
                "value": "This CLI option has been removed from the fixed Junos releases.\n\nThe following software releases have been updated to resolve this specific issue: 12.1X46-D77, 12.3R12-S10, 12.3X48-D75, 14.1X53-D47, 15.1R4-S9, 15.1R6-S6, 15.1R7, 15.1X49-D131, 15.1X49-D140, 15.1X53-D233, 15.1X53-D471, 15.1X53-D490, 15.1X53-D59, 15.1X53-D67, 16.1R3-S9, 16.1R4-S9, 16.1R5-S4, 16.1R6-S4, 16.1R7, 16.2R2-S5, 17.1R1-S7, 17.1R2-S7, 17.1R3, 17.2R1-S6, 17.2R2-S4, 17.2R3, 17.2X75-D110, 17.2X75-D91, 17.3R1-S4, 17.3R2-S2, 17.3R3, 17.4R1-S3, 17.4R2, 18.1R1, 18.2R1, 18.2X75-D5, and all subsequent releases.\n"
            }
        ],
        "source": {
            "advisory": "JSA10886",
            "defect": [
                "1288932"
            ],
            "discovery": "INTERNAL"
        },
        "work_around": [
            {
                "lang": "eng",
                "value": "Ensure there is no RSH service listening on port 514.\n\nUtilize common security BCPs to limit the exploitable surface by limiting access to network and device to trusted systems, administrators, networks and hosts."
            }
        ]
    },
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "5.0"
}